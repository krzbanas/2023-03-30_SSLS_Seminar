<!DOCTYPE html>
<html lang="" xml:lang="">
  <head>
    <title>Classification of the Residues after High and Low Order Explosions</title>
    <meta charset="utf-8" />
    <meta name="author" content="Krzysztof Banas SSLS " />
    <meta name="date" content="2023-03-30" />
    <script src="index_files/header-attrs/header-attrs.js"></script>
    <script src="index_files/fabric/fabric.min.js"></script>
    <link href="index_files/xaringanExtra-scribble/scribble.css" rel="stylesheet" />
    <script src="index_files/xaringanExtra-scribble/scribble.js"></script>
    <script>document.addEventListener('DOMContentLoaded', function() { window.xeScribble = new Scribble({"pen_color":["#FF0000"],"pen_size":3,"eraser_size":30,"palette":[]}) })</script>
    <link href="index_files/tile-view/tile-view.css" rel="stylesheet" />
    <script src="index_files/tile-view/tile-view.js"></script>
    <script src="index_files/xaringanExtra-progressBar/progress-bar.js"></script>
    <link rel="stylesheet" href="xaringan-themer.css" type="text/css" />
  </head>
  <body>
    <textarea id="source">
class: center, middle, inverse, title-slide

.title[
# Classification of the Residues after High and Low Order Explosions
]
.subtitle[
## using Machine Learning Techniques on Fourier Transform Infrared (FTIR) spectra
]
.author[
### Krzysztof Banas<br><span style="font-size: 80%;">SSLS<br></span>
]
.date[
### 2023-03-30
]

---










class: inverse center middle

# Introduction

---


## SPF Project

.pull-left[

*   in collaboration with SPF
*   high and low order explosions
*   debris collected
*   analysed with infrared spectroscopy: FTIR spectrometer
]

.pull-right[


![Test](FIGURES/explosion.png)
]

---
## Experiments

.pull-left[

- KBr pellets
- mid-IR range
- multiple spectra measured
- spectral signatures from high energetic material
- ... but also from the surface material (paper, plastic, textile)
]

.pull-right[


]

![Test](FIGURES/table_spectra.png)

---
## Motivation for this sub-project

.pull-left[

*   check which materials are more suitable as sample collectors
*   check what is the influence of the order of explosion on the classification 
*   investigate dimension reduction method in combination with discrimination
*   building classification model: combined PCA-LDA

]

.pull-right[
![Test](FIGURES/LDA_02.png)


]


---
class: inverse center middle

# Results

---

## Spectral Data
.pull-left[

*   typically more variables than observations
*   variables are highly correlated and auto-correlated
*   before modeling need for dimension reduction
*   pre-processing
]

.pull-right[

![Test](FIGURES/raw_spectra.png)
]
---

## Pre-processing
.pull-left[

![Test](FIGURES/raw_spectra.png)
]

.pull-right[

![Test](FIGURES/norm_spectra.png)
]

---
class: inverse center middle
## Dimension Reduction

---
## How PCA works


![Test](FIGURES/PCA_2d_to_1d.png)]


---
## How PCA works

![Test](FIGURES/pca-anim.webp)]


---
## PCA on decathlon dataset
&lt;table&gt;
 &lt;thead&gt;
  &lt;tr&gt;
   &lt;th style="text-align:left;"&gt;   &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X100m &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Long.jump &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Shot.put &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; High.jump &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X400m &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; X110m.hurdle &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Discus &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Pole.vault &lt;/th&gt;
   &lt;th style="text-align:right;"&gt; Javeline &lt;/th&gt;
  &lt;/tr&gt;
 &lt;/thead&gt;
&lt;tbody&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; SEBRLE &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.04 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.58 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.83 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.07 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.81 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.69 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 43.75 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.02 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63.19 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; CLAY &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.76 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.40 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.86 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.37 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.05 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50.72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.92 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 60.15 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; BERNARD &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.02 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.23 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.25 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.92 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 48.93 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.99 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 40.87 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 5.32 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 62.77 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; YURKOV &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.34 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.09 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.19 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50.42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.31 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 46.26 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.72 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 63.44 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; ZSIVOCZKY &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.30 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.48 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.01 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 48.62 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.17 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 45.67 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 55.37 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; McMULLEN &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 10.83 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.31 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 13.76 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 2.13 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 49.91 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.38 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44.41 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.42 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 56.37 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; MARTINEAU &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.64 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 6.81 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.57 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.95 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 50.14 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.93 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 47.60 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.92 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 52.33 &lt;/td&gt;
  &lt;/tr&gt;
  &lt;tr&gt;
   &lt;td style="text-align:left;"&gt; HERNU &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 11.37 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 7.56 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 14.41 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 1.86 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 51.10 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 15.06 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 44.99 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 4.82 &lt;/td&gt;
   &lt;td style="text-align:right;"&gt; 57.19 &lt;/td&gt;
  &lt;/tr&gt;
&lt;/tbody&gt;
&lt;/table&gt;


---
## Correlation between variables

&lt;img src="index_files/figure-html/unnamed-chunk-2-1.png" width="100%" /&gt;



---
## Principal Components: screeplot and scoreplot

&lt;img src="index_files/figure-html/unnamed-chunk-3-1.png" width="100%" /&gt;

---
## Loadings
&lt;img src="index_files/figure-html/unnamed-chunk-4-1.png" width="100%" /&gt;


---
## Principal Components: screeplot and scoreplot
&lt;img src="index_files/figure-html/unnamed-chunk-5-1.png" width="100%" /&gt;


---
## Biplot
&lt;img src="index_files/figure-html/unnamed-chunk-6-1.png" width="100%" /&gt;



---
## PCA: Practical Applications

- Finance: analyze stock market data to identify patterns 
- Image compression: compress digital images 
- Genetics: analyze genetic data to identify patterns
- Social media: social media data to identify trends in user behavior and preferences
- Marketing: consumer data to identify patterns in purchasing behavior and preferences
- Healthcare: patient data to identify risk factors and predict outcomes
- Quality control: manufacturing data to identify patterns in product quality and performance
- Agriculture: crop data to identify patterns in yields and optimize farming practices
- Climate research: climate data to identify patterns in weather patterns and predict future climate trends
- Sports: player data to identify key factors that contribute to winning games and championships.



---
## PCA for spectrosopic data
.pull-left[
- dimension reduction
- removing correlation between variables
- finding patters
- unsupervised method
- *lossy technique*
- *scaling variables can yield different results*
- *problems with interpretation: PCs are linear combination of original features*
]
.pull-right[

]

---
## Loadings and contribution plot
.pull-left[
![Test](FIGURES/loadings_spectra.png)
]
.pull-right[
- first two PCA
- all wavenumbers
- colour coded contribution cos&lt;sup&gt;2&lt;/sup&gt; contribution to PC1 and PC2
]


---
## Scoreplots

.pull-left[
![Test](FIGURES/scoreplot_spectra.png)
]
.pull-right[
- first two PCA
- all observations (spectra)
- colour coded class membership (explosive and order)
]


---
class: inverse center middle
## Identification/Classification/Grouping

---
## 2D partitions
&lt;img src="FIGURES/partition_plot.png"
     width="800px"
     style="position:absolute; left:10px; top:130px;"&gt;
---
## Building Classification Model

-  first use PCA on spectral data for dimension reduction
-  then use LDA to build the Classification Model using a first few PC's
-  test the Classification Model with new data
---
## How LDA works

.pull-left[
Source: Linear discriminant analysis : a detailed tutorial Gaber, T, Tharwat, A, Ibrahim, A and Hassanien, AE AI Communications (2017)
]

.pull-right[
&lt;img src="FIGURES/LDA_00.png" width="500px" /&gt;
]


---
## Data Preparation for LDA

- **Classification Problems** applied to classify the categorical output variable (suitable for binary and multi-class classification problems)
- **Gaussian Distribution** The standard LDA model applies the Gaussian Distribution of the input variables. One should review the univariate distribution of each variable and transform them into more Gaussian-looking distributions (use log and root for exponential distributions and Box-Cox for skewed distributions)
- **Remove Outliers** It is good to firstly remove the outliers from your data because these outliers can skew the basic statistics used to separate classes in LDA, such as the mean and the standard deviation
- **Same Variance** As LDA always assumes that all the input variables have the same variance, hence it is always a better way to firstly standardize the data before implementing an LDA model. By this, the mean will be 0, and it will have a standard deviation of 1.

---
class: inverse center middle
## LDA on principal components

---
## Discriminant functions plot
.pull-left[
![Test](FIGURES/LDA_01.png)
]
.pull-right[
- first two linear discriminant functions
- all observations (originaly spectra) 
- colour coded class membership (explosive and order)
]

---
## Comparison

.pull-left[
### PCA
- unsupervised
- maximize the variance in the given dataset
- good performer for a comparatively small sample size

]
.pull-right[
### LDA
- supervised
- find the linear discriminants to represent the axes that maximize separation between different classes
- more suitable for multi-class classification tasks
]

---
class: inverse center middle

# Conclusions

---
## Take home message

- Spectroscopic data are multidimensional and highly correlated
--

- PCA "transfers" most variability of the system to the first few principal components
--

- PCA removes correlation between variables
--

- For classification model we need another method: LDA
--

- With PCs as input variables LDA works well in predicting the class membership
--

- We can validate model with various statistical methods, for example Leave-One-Out


---
## Where to find:

.pull-left[

### Manuscript:

![Paper](FIGURES/banas2023a.html.png)
]


.pull-right[

### Slides: 
https://krzbanas.github.io/2023-03-30_SSLS_Seminar

![Seminar](FIGURES/seminar_title.png)

]


---
class: center, middle

# Thank You!

Slides created via the R packages:

[**xaringan**](https://github.com/yihui/xaringan)&lt;br&gt;
[gadenbuie/xaringanthemer](https://github.com/gadenbuie/xaringanthemer)

The chakra comes from [remark.js](https://remarkjs.com), [**knitr**](http://yihui.name/knitr), and [R Markdown](https://rmarkdown.rstudio.com).
    </textarea>
<style data-target="print-only">@media screen {.remark-slide-container{display:block;}.remark-slide-scaler{box-shadow:none;}}</style>
<script src="https://remarkjs.com/downloads/remark-latest.min.js"></script>
<script>var slideshow = remark.create({
"slideNumberFormat": "%current%",
"highlightStyle": "github",
"highlightLines": true,
"ratio": "16:9",
"countIncrementalSlides": true
});
if (window.HTMLWidgets) slideshow.on('afterShowSlide', function (slide) {
  window.dispatchEvent(new Event('resize'));
});
(function(d) {
  var s = d.createElement("style"), r = d.querySelector(".remark-slide-scaler");
  if (!r) return;
  s.type = "text/css"; s.innerHTML = "@page {size: " + r.style.width + " " + r.style.height +"; }";
  d.head.appendChild(s);
})(document);

(function(d) {
  var el = d.getElementsByClassName("remark-slides-area");
  if (!el) return;
  var slide, slides = slideshow.getSlides(), els = el[0].children;
  for (var i = 1; i < slides.length; i++) {
    slide = slides[i];
    if (slide.properties.continued === "true" || slide.properties.count === "false") {
      els[i - 1].className += ' has-continuation';
    }
  }
  var s = d.createElement("style");
  s.type = "text/css"; s.innerHTML = "@media print { .has-continuation { display: none; } }";
  d.head.appendChild(s);
})(document);
// delete the temporary CSS (for displaying all slides initially) when the user
// starts to view slides
(function() {
  var deleted = false;
  slideshow.on('beforeShowSlide', function(slide) {
    if (deleted) return;
    var sheets = document.styleSheets, node;
    for (var i = 0; i < sheets.length; i++) {
      node = sheets[i].ownerNode;
      if (node.dataset["target"] !== "print-only") continue;
      node.parentNode.removeChild(node);
    }
    deleted = true;
  });
})();
// add `data-at-shortcutkeys` attribute to <body> to resolve conflicts with JAWS
// screen reader (see PR #262)
(function(d) {
  let res = {};
  d.querySelectorAll('.remark-help-content table tr').forEach(tr => {
    const t = tr.querySelector('td:nth-child(2)').innerText;
    tr.querySelectorAll('td:first-child .key').forEach(key => {
      const k = key.innerText;
      if (/^[a-z]$/.test(k)) res[k] = t;  // must be a single letter (key)
    });
  });
  d.body.setAttribute('data-at-shortcutkeys', JSON.stringify(res));
})(document);
(function() {
  "use strict"
  // Replace <script> tags in slides area to make them executable
  var scripts = document.querySelectorAll(
    '.remark-slides-area .remark-slide-container script'
  );
  if (!scripts.length) return;
  for (var i = 0; i < scripts.length; i++) {
    var s = document.createElement('script');
    var code = document.createTextNode(scripts[i].textContent);
    s.appendChild(code);
    var scriptAttrs = scripts[i].attributes;
    for (var j = 0; j < scriptAttrs.length; j++) {
      s.setAttribute(scriptAttrs[j].name, scriptAttrs[j].value);
    }
    scripts[i].parentElement.replaceChild(s, scripts[i]);
  }
})();
(function() {
  var links = document.getElementsByTagName('a');
  for (var i = 0; i < links.length; i++) {
    if (/^(https?:)?\/\//.test(links[i].getAttribute('href'))) {
      links[i].target = '_blank';
    }
  }
})();
(function(time) {
  var d2 = function(number) {
    return ('0' + number).slice(-2); // left-pad 0 to minutes/seconds
  },

  time_format = function(total) {
    var secs = Math.abs(total) / 1000;
    var h = Math.floor(secs / 3600);
    var m = Math.floor(secs % 3600 / 60);
    var s = Math.round(secs % 60);
    var res = d2(m) + ':' + d2(s);
    if (h > 0) res = h + ':' + res;
    return res;  // [hh:]mm:ss
  },

  slide_number_div = function(i) {
    return document.getElementsByClassName('remark-slide-number').item(i);
  },

  current_page_number = function(i) {
    return slide_number_div(i).firstChild.textContent;  // text "i / N"
  };

  var timer = document.createElement('span'); timer.id = 'slide-time-left';
  var time_left = time, k = slideshow.getCurrentSlideIndex(),
      last_page_number = current_page_number(k);

  setInterval(function() {
    time_left = time_left - 1000;
    timer.innerHTML = ' ' + time_format(time_left);
    if (time_left < 0) timer.style.color = 'red';
  }, 1000);

  slide_number_div(k).appendChild(timer);

  slideshow.on('showSlide', function(slide) {
    var i = slide.getSlideIndex(), n = current_page_number(i);
    // reset timer when a new slide is shown and the page number is changed
    if (last_page_number !== n) {
      time_left = time; last_page_number = n;
      timer.innerHTML = ' ' + time_format(time); timer.style.color = null;
    }
    slide_number_div(i).appendChild(timer);
  });
})(60000);
// adds .remark-code-has-line-highlighted class to <pre> parent elements
// of code chunks containing highlighted lines with class .remark-code-line-highlighted
(function(d) {
  const hlines = d.querySelectorAll('.remark-code-line-highlighted');
  const preParents = [];
  const findPreParent = function(line, p = 0) {
    if (p > 1) return null; // traverse up no further than grandparent
    const el = line.parentElement;
    return el.tagName === "PRE" ? el : findPreParent(el, ++p);
  };

  for (let line of hlines) {
    let pre = findPreParent(line);
    if (pre && !preParents.includes(pre)) preParents.push(pre);
  }
  preParents.forEach(p => p.classList.add("remark-code-has-line-highlighted"));
})(document);</script>

<script>
slideshow._releaseMath = function(el) {
  var i, text, code, codes = el.getElementsByTagName('code');
  for (i = 0; i < codes.length;) {
    code = codes[i];
    if (code.parentNode.tagName !== 'PRE' && code.childElementCount === 0) {
      text = code.textContent;
      if (/^\\\((.|\s)+\\\)$/.test(text) || /^\\\[(.|\s)+\\\]$/.test(text) ||
          /^\$\$(.|\s)+\$\$$/.test(text) ||
          /^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text)) {
        code.outerHTML = code.innerHTML;  // remove <code></code>
        continue;
      }
    }
    i++;
  }
};
slideshow._releaseMath(document);
</script>
<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
(function () {
  var script = document.createElement('script');
  script.type = 'text/javascript';
  script.src  = 'https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML';
  if (location.protocol !== 'file:' && /^https?:/.test(script.src))
    script.src  = script.src.replace(/^https?:/, '');
  document.getElementsByTagName('head')[0].appendChild(script);
})();
</script>
  </body>
</html>
